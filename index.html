<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <!-- <script src="./getJSON.js"></script>-->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        

        <style>
            th{
                color:#fff;
            }

            .toggle{    display: none;
            }

            .foo td {
                padding: 1em;
                border: 1px solid black;
            }
            .myButton {
                background:url(./arrow.png) no-repeat;
                cursor:pointer;
                width: 20%;
                height: 20%;
            }

        </style>

</head>
<body>
        <table class="table table-striped">
            <tr  class="bg-info">
                <th></th>
                <th>URL</th>
                <th>totalUser</th>
                <th>totalRequest</th>
                <th>totalDuration</th>

            </tr>

            <tbody class="myTable">
                
            </tbody>
        </table>
<script>
            var myArray = [
                {'name':'Michael', 'age':'30', 'birthdate':'11/10/1989'},
                {'name':'Mila', 'age':'32', 'birthdate':'10/1/1989'},
                {'name':'Paul', 'age':'29', 'birthdate':'10/14/1990'},
                {'name':'Dennis', 'age':'25', 'birthdate':'11/29/1993'},
                {'name':'Tim', 'age':'27', 'birthdate':'3/12/1991'},
                {'name':'Erik', 'age':'24', 'birthdate':'10/31/1995'},
            ];

            var myArray1 = {"dataMethod":[{"URL":"/providerApi/incomingRequest","data_id":{"3684765":["POST","224.4"]},"user_id":{"440":1},"duration":"224.4","count":1,"totalDuration":"224.4","totalUser":1,"maxDuration":"224.4"}],"dataURL":[{"URL":"/providerApi/incomingRequest","data_id":[["3684617","POST",null,"242.8"],["3684636","POST",null,"205.4"],["3684641","POST",null,"248.4"],["3684650","POST",null,"236.7"],["3684656","POST",null,"228.7"],["3684674","POST",null,"219.8"],["3684712","POST",null,"220.3"],["3684718","POST",null,"215.1"],["3684765","POST",null,"224.4"]],"user_id":[["440",1]],"duration":"224.4","count":9,"totalDuration":"2041.60","totalUser":9,"maxDuration":248.4},{"URL":"/providerApi/requestStatusCheck","data_id":[["3684614","POST",null,"270.2"],["3684633","POST",null,"268.6"],["3684638","POST",null,"295.8"],["3684648","POST",null,"327.5"],["3684654","POST",null,"259.2"],["3684672","POST",null,"275.6"],["3684710","POST",null,"276.9"],["3684717","POST",null,"264.0"],["3684763","POST",null,"284.2"]],"user_id":[["440",1]],"duration":"284.2","count":9,"totalDuration":"2522.00","totalUser":9,"maxDuration":327.5},{"URL":"/userApi/fleets/reminders/2869","data_id":[["3684729","POST",null,"716.2"]],"user_id":[["1868",1]],"duration":"716.2","count":1,"totalDuration":"716.2","totalUser":1,"maxDuration":"716.2"},{"URL":"/providerApi/inspect/upload/cloud","data_id":[["3684685","POST",null,"1811.3"],["3684701","POST",null,"1200.6"],["3684720","POST",null,"639.1"],["3684721","POST",null,"763.3"]],"user_id":[["440",1]],"duration":"763.3","count":4,"totalDuration":"4414.30","totalUser":4,"maxDuration":1811.3},{"URL":"/providerApi/availableUpdate","data_id":[["3684715","POST",null,"212.6"]],"user_id":[["440",1]],"duration":"212.6","count":1,"totalDuration":"212.6","totalUser":1,"maxDuration":"212.6"},{"URL":"/userApi/serviceList","data_id":[["3684629","POST",null,"906.4"]],"user_id":[["2762",1]],"duration":"906.4","count":1,"totalDuration":"906.4","totalUser":1,"maxDuration":"906.4"},{"URL":"/userApi/inspect/cancelRequest","data_id":[["3684628","POST",null,"349.2"]],"user_id":[["2762",1]],"duration":"349.2","count":1,"totalDuration":"349.2","totalUser":1,"maxDuration":"349.2"},{"URL":"/userApi/requestStatusCheck","data_id":[["3684562","POST",null,"253.4"],["3684624","POST",null,"243.5"]],"user_id":[["2762",1]],"duration":"243.5","count":2,"totalDuration":"496.90","totalUser":2,"maxDuration":253.4},{"URL":"/userApi/inspect/start","data_id":[["3684576","POST",null,"1726.7"]],"user_id":[["2762",1]],"duration":"1726.7","count":1,"totalDuration":"1726.7","totalUser":1,"maxDuration":"1726.7"},{"URL":"/userApi/inspect","data_id":[["3684561","POST",null,"520.0"]],"user_id":[["2762",1]],"duration":"520.0","count":1,"totalDuration":"520.0","totalUser":1,"maxDuration":"520.0"}]};

        //     var myArray1 = {
        //     "dataMethod": {
        //         "POST": {
        //             "URL": "/providerApi/requestStatusCheck",
        //             "data_id": {
        //                 "3573147": [
        //                     {
        //                         "0": "3573147"
        //                     },
        //                     {
        //                         "2": "POST"
        //                     },
        //                     {
        //                         "3": "280.4"
        //                     }
        //                 ],
        //                 "3573147": [
        //                     {
        //                         "0": "3573147"
        //                     },
        //                     {
        //                         "2": "POST"
        //                     },
        //                     {
        //                         "3": "280.4"
        //                     }
        //                 ]
        //             },
        //             "user_id": {
        //                 "346": 1,
        //                 "346": 1,
        //                 "346": 1
        //             },
        //             "duration": "280.4",
        //             "count": 1,
        //             "totalDuration": "280.4",
        //             "totalUser": 2

        //         },
        //         "GET": {
        //             "URL": "/providerApi/userdetails",
        //             "data_id": {
        //                 "3573143": [
        //                     {
        //                         "0": "GET"
        //                     },
        //                     {
        //                         "1": "210.8"
        //                     }
        //                 ]
        //             },
        //             "user_id": {
        //                 "346": 1
        //             },
        //             "duration": "210.8",
        //             "count": 1,
        //             "totalDuration": "210.8",
        //             "totalUser": 2

        //         }
        //     },
        //     "dataURL": [
        //         {
        //             "URL": "/providerApi/requestStatusCheck",
        //              "data_id": [
        //                 {"data_id":"3573093", "duration":"231.0","method":"GET"},
        //                 {"data_id":"3573101", "duration":"245.1","method":"GET"},
        //                 {"data_id":"3573108", "duration":"245.9","method":"GET"},
        //                 {"data_id":"3573116", "duration":"474.1","method":"GET"},
        //                 {"data_id":"3573124", "duration":"259.4","method":"GET"},
        //                 {"data_id":"3573139", "duration":"269.8","method":"GET"},
        //                 {"data_id":"3573147", "duration":"280.4","method":"GET"}
        //             ],
        //             "user_id": [
        //                 {"user_id":"57", "count":"2"},
        //                 {"user_id":"23", "count":"3"},
        //                 {"user_id":"31", "count":"4"}
        //             ],
        //             "duration": "280.4",
        //             "count": 9,
        //             "totalDuration": "2005.70",
        //             "totalUser": 3
        //         },
        //          {
        //             "URL": "/providerApi/availableUpdate",
        //             "data_id": [
        //                 {"data_id":"3573096", "duration":"217.9","method":"GET"},
        //                 {"data_id":"3573104", "duration":"274.1","method":"GET"},
        //                 {"data_id":"3573106", "duration":"220.5","method":"GET"},
        //                 {"data_id":"3573121", "duration":"198.8","method":"GET"},
        //                 {"data_id":"3573129", "duration":"281.2","method":"GET"},
        //                 {"data_id":"3573144", "duration":"202.8","method":"GET"}
        //             ],
        //             "user_id": [
        //                 {"user_id":"57", "count":"2"},
        //                 {"user_id":"23", "count":"3"},
        //                 {"user_id":"31", "count":"3"}
        //             ],
        //             "duration": "202.8",
        //             "count": 8,
        //             "totalDuration": "1395.30",
        //             "totalUser": 3
        //         },
        //          {
        //             "URL": "/providerApi/incomingRequest",
        //             "data_id": [
        //                 {"data_id":"3573088", "duration":"227.3","method":"GET"},
        //                 {"data_id":"3573094", "duration":"232.4","method":"GET"},
        //                 {"data_id":"3573102", "duration":"227.4","method":"GET"},
        //                 {"data_id":"3573110", "duration":"224.4","method":"GET"},
        //                 {"data_id":"3573119", "duration":"234.9","method":"GET"},
        //                 {"data_id":"3573127", "duration":"204.8","method":"GET"},
        //                 {"data_id":"3573142", "duration":"200.3","method":"GET"}
        //             ],
        //             "user_id": [
        //                 {"user_id":"57", "count":"2"},
        //                 {"user_id":"23", "count":"3"},
        //                 {"user_id":"31", "count":"2"}
        //             ],
        //             "duration": "200.3",
        //             "count": 7,
        //             "totalDuration": "1551.50",
        //             "totalUser": 3
        //         }
        //         ]
            
        // };
        </script>
        <script>

        // let text = 'true';
        //     const getTxt = async () => {
        //         const res = await fetch('/consoleText.txt');
        //          text = await res.text()
        //         console.log("====================");

        //         console.log(text);
        //     }
        // getTxt();

        //     //const fs = require('fs');
        //     // var fs = require('fs');
        //     // //var fs = 42;


        //     // fs.readFile('./consoleText.txt', 'utf-8', (err, data) => {
        //     //   if (err) {
        //     //     throw err;
        //     //   }
        //     //       console.log("====================");

        //     //   console.log(data);
        //     // });

        //     console.log(text);


            
            
            buildTable(myArray,myArray1)


            $("button").click(function() {

                let fired_button = $(this).val();

                let arrayClass = fired_button.split(',');

                $('.'+arrayClass[0]).toggle();
                
                let elem1 = document.getElementsByClassName(arrayClass[1])[0];
                let theCSSprop1 = window.getComputedStyle(elem1,null).getPropertyValue("display");

                let elem2 = document.getElementsByClassName(arrayClass[2])[0];
                let theCSSprop2 = window.getComputedStyle(elem2,null).getPropertyValue("display");

                    if (theCSSprop1=='table-row'){
                        $('.toggle.'+arrayClass[1]).toggle();
                    }
                    if (theCSSprop2=='table-row'){
                        $('.toggle.'+arrayClass[2]).toggle();
                    }       
            });



            function buildTable(data,data2){
                var table = document.getElementsByClassName('myTable')[0];
                
                for(var i = 0; i < data2.dataURL.length; i++){
                    var row =   `<tr class="foo" id="b">
                                    <!--<td><button class="" value="b`+i+`,d`+i+`,c`+i+`">"+"</button></td>-->
                                    <td><button class="" value="b`+i+`,d`+i+`,c`+i+`">"+"</button></td>
                                    <td>${data2.dataURL[i].URL}</td>
                                    <td>${data2.dataURL[i].totalUser}</td>
                                    <td>${data2.dataURL[i].count}</td>
                                    <td>${data2.dataURL[i].totalDuration}</td>
                                </tr>
                              
                                <tr  class="bg-info toggle b`+i+`">                                  
                                    <th><button class="" value="d`+i+`">"+"</button></th>
                                    <th>User_id</th>
                                    <th>CountRequest</th>
                                    <th></th>
                                    <th></th>
                                </tr>`
                               
                    table.innerHTML += row;



                    for(var j = 0; j < data2.dataURL[i].user_id.length; j++){  
                        var row = `<tr class="toggle d`+i+`">
                                            <td></td>
                                            <td>${data2.dataURL[i].user_id[j][0]}</td>
                                            <td>${data2.dataURL[i].user_id[j][1]}</td>
                                            <th></th>
                                            <th></th>
                                        </tr>`

                        table.innerHTML += row;

                    }              

                    var row =`<tr  class="bg-info toggle b`+i+` ">  
                                <th><button class="" value="c`+i+`">"+"</button></th>
                                <th>Data_id</th>
                                <th>Method</th>
                                <th>Response</th>
                                <th>Duration</th>
                              </tr>`

                    table.innerHTML += row;

                    for(var j = 0; j < data2.dataURL[i].data_id.length; j++){  
                         var row =   `<tr class="toggle c`+i+`">
                                        <td></td>
                                        <td><a href="https://sandbox.driveroo.com/admin/clockwork/${data2.dataURL[i].data_id[j][0]}" target="_blank">${data2.dataURL[i].data_id[j][0]}</td>
                                        <td>${data2.dataURL[i].data_id[j][1]}</td>
                                       <td>${data2.dataURL[i].data_id[j][2]}</td>
                                       <td>${data2.dataURL[i].data_id[j][3]}</td>
                                    </tr>`

                    table.innerHTML += row;

                    }            
                }
            }

        </script>
</body>
</html>